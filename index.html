<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)">

    <!-- <link rel="icon" href="assets/favicon.ico"> -->

    <link rel="mask-icon" href="https://theme-next.js.org/images/logo.svg" color="#222">
    <link rel="stylesheet" href="https://theme-next.js.org/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css">
    <link rel="stylesheet" href="./css/style.css">

    <script class="next-config" data-name="main" type="application/json">
    {
        "hostname": "theme-next.js.org",
        "root": "/",
        "images": "/images",
        "scheme": "Gemini",
        "darkmode": true,
        "version": "8.20.0",
        "exturl": true,
        "sidebar": {
            "position": "left",
            "width_expanded": 320,
            "width_dual_column": 240,
            "display": "post",
            "padding": 18,
            "offset": 12
        },
        "copycode": {
            "enable": true,
            "style": "default"
        },
        "fold": {
            "enable": false,
            "height": 500
        },
        "bookmark": {
            "enable": false,
            "color": "#222",
            "save": "auto"
        },
        "mediumzoom": true,
        "lazyload": false,
        "pangu": false,
        "comments": {
            "style": "tabs",
            "active": null,
            "storage": true,
            "lazyload": true,
            "nav": null
        },
        "stickytabs": false,
        "motion": {
            "enable": true,
            "async": true,
            "transition": {
                "menu_item": "fadeInDown",
                "post_block": "fadeIn",
                "post_header": "fadeInDown",
                "post_body": "fadeInDown",
                "coll_header": "fadeInLeft",
                "sidebar": "fadeInUp"
            }
        },
        "path": "/search.json",
        "localsearch": {
            "enable": true,
            "trigger": "auto",
            "top_n_per_article": 1,
            "unescape": false,
            "preload": false
        }
    }

    </script>

    <meta name="description" content="NexT - An elegant and powerful theme for Hexo.">
    <title>Archive | NexT</title>
</head>

<body itemscope class="use-motion">
    <noscript>
        <strong>
            We're sorry but <%= htmlWebpackPlugin.options.title %> doesn't work properly without JavaScript enabled.
                Please enable it to continue.
        </strong>
    </noscript>
    <div id="app"></div>
    <div class="headband"></div>

    <div class="popup-bg"></div>
    <div class="popup">
        <img class="popup-image" src="./assets/2019/0fbea86c3c421e285775261ad8f3d74b.jpeg" alt="Big Image">
        <div class="popup-info"></div>
    </div>

    <main class="main">
        <div class="column">
            <header class="header" itemscope>
                <div class="site-brand-container">
                    <div class="site-nav-toggle">
                        <div class="toggle" aria-label="Toggle navigation bar" role="button">
                        </div>
                    </div>
                    <div class="site-meta">
                        <a href="https://www.fyscu.com" class="brand" rel="start">
                            <i class="logo-line"></i>
                            <h1 class="site-title">飞扬俱乐部</h1>
                            <i class="logo-line"></i>
                        </a>
                        <p class="site-subtitle" itemprop="description">
                            —— 我们的团队
                        </p>
                    </div>

                    <div class="site-nav-right">
                        <div class="toggle popup-trigger" aria-label="Search" role="button">
                        </div>
                    </div>
                </div>
            </header>
        </div>

        <div class="main-inner archive posts-collapse">
            <div class="post-block">
                <div id="app_container" class="post-content">
                    <div class="collection-title">
                        <span class="collection-header">
                            四川大学飞扬俱乐部，创建于2003年9月
                            一个集技术交流、电脑维修、软件研发、网站小程序等建设维护于一体的专业公益IT社团
                            飞扬秉承“创新实践，服务川大”理念，旨在通过专业技术应用及研发服务大众
                            向川大师生提供免费的电脑维修维护及其他科技服务
                        </span>
                    </div>

                    <!-- <div class="collection-year">
                        <span class="collection-header">
                            2024飞扬部长团
                            <span class="collection-year-count">20人</span>
                        </span>
                    </div>

                    <article itemscope>
                        <header class="post-header">
                            <div class="post-title">
                                <a class="post-title-link">
                                    <span itemprop="name">2024·研发部</span>
                                </a>
                            </div>
                            <div class="avatars-container"></div>
                        </header>
                    </article> -->
                </div>
            </div>
        </div>
    </main>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/config.min.js"
        defer></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"
        defer></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js"
        defer></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/utils.min.js"
        defer></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/motion.min.js"
        defer></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-next/8.20.0/next-boot.min.js"
        defer></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.lazy/1.7.10/jquery.lazy.min.js">
    </script>
    <script>
        // function addScript(scriptSrc) {
        //     // 创建 script 元素
        //     var script = document.createElement('script');
        //     script.src = scriptSrc;
        //     // script.defer = true; // 可以选择添加 defer 属性
        //     document.head.appendChild(script); // 将脚本添加到文档中
        // }

        function countStaff(yearData) {
            let res = 0;
            yearData.positions.forEach(position => {
                res += position.staffs.length;
            });
            return res;
        }

        function buildDOM(params) {
            var appContainer = ("#app_container");
            $.ajax({
                method: "GET",      // 设置请求方式为GET
                url: "./data.json", // 加载本地json文件
                dataType: "json",   // 设置数据类型为json
                success: function (data) {
                    console.log("data:", data);  // 输出结果
                    let appContainer = $('#app_container');
                    // $.each(data, function (index, yearData) {
                    data.forEach(yearData => {
                        let year = yearData.year;
                        let positions = yearData.positions;
                        let collectionYearCountSpan = $('<span>')
                            .addClass('collection-year-count')
                            .text(countStaff(yearData))
                            .append($('<i>').addClass("fas fa-user fa-xs"));
                        let collectionHeaderDiv = $('<span>')
                            .addClass('collection-header')
                            .text(`${year} 部长团`)
                            .append(collectionYearCountSpan);
                        let collectionYearDiv = $('<div>')
                            .addClass('collection-year')
                            .append(collectionHeaderDiv);
                        appContainer.append(collectionYearDiv);
                        positions.forEach(position => {
                            let positionName = position.name;
                            let staffs = position.staffs;
                            let avatarsContainerDiv = $('<div>').addClass('avatars-container');
                            let postTitleLink = $('<a>')
                                .addClass('post-title-link')
                                .append($('<span>')
                                    .attr('itemprop', 'name')
                                    .text(`${year}·${positionName}`)
                                );
                            let postTitleDiv = $('<div>')
                                .addClass('post-title')
                                .append(postTitleLink);
                            staffs.forEach(staff => {
                                let name = staff.name;
                                let saying = staff.saying;
                                let avatar = staff.avatar;
                                let photo = staff.photo;
                                let avatarImg = $('<img>')
                                    .addClass('thumbnail lazy')
                                    .attr('data-src', `./assets/${year}/${staff.avatar}`);
                                let overlay = $('<div>').addClass('overlay').text(name);
                                let avatarDiv = $('<div>')
                                    .addClass('avatar')
                                    .append(avatarImg)
                                    .append(overlay)
                                    .click(function () {
                                        $('.popup-info').empty()
                                            .append($('<h1>')
                                                .addClass('staff-name animated fadeInDown')
                                                .text(name)
                                            ).append($('<p>')
                                                .addClass('staff-saying animated fadeInDown')
                                                .text(saying)
                                            ).append($('<p>')
                                                .addClass('staff-position animated fadeInDown')
                                                .text("职位：" + positionName)
                                            );
                                        $('.popup-image').attr('src', `./assets/${year}/${photo}`);
                                        $('.popup-bg').fadeIn().addClass('animated fadeIn');
                                        $('.popup').fadeIn().addClass('animated fadeInLeft');
                                    });
                                avatarsContainerDiv.append(avatarDiv);
                            });
                            let postHeader = $('<header>')
                                .addClass('post-header')
                                .append(postTitleDiv)
                                .append(avatarsContainerDiv);
                            let article = $('<article>')
                                .attr('itemscope', '')
                                .append(postHeader);
                            appContainer.append(article);
                        });
                    });
                    $("img.lazy").Lazy({
                        effect: "fadeIn",
                        effectTime: 1000,
                        threshold: 0
                    });
                    $('.popup-bg').click(function () {
                        $('.popup-bg').fadeOut().removeClass('animated fadeIn');
                        $('.popup').fadeOut().removeClass('animated fadeInLeft');
                    });
                    // 刷新 NexT 元素
                    NexT.boot.registerEvents();
                    NexT.boot.refresh();
                    NexT.boot.motion();
                }
            });
        }

        $(document).ready(function () {
            buildDOM();
            NexT.boot.registerEvents();
            NexT.boot.refresh();
            NexT.boot.motion();
        });
    </script>
</body>

</html>
